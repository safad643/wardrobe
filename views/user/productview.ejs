	<%- include("../../views/partials/user/header") %>
		<style>
			.custom-notification {
							position: fixed;
							bottom: -100px;
							left: 50%;
							transform: translateX(-50%);
							background-color: #4CAF50;
							color: white;
							padding: 15px 30px;
							border-radius: 25px;
							font-family: Arial, sans-serif;
							font-size: 16px;
							box-shadow: 0 2px 5px rgba(0,0,0,0.2);
							opacity: 0;
							visibility: hidden;
							transition: all 0.4s ease-out;
							z-index: 9999;
							display: flex;
							align-items: center;
							gap: 10px;
					}

					.custom-notification.active {
							bottom: 20px;
							opacity: 1;
							visibility: visible;
					}

					.custom-notification::before {
							content: '✓';
							font-weight: bold;
							font-size: 18px;
					}

					.wishlist-heart-container {
							text-align: right;
							margin-bottom: 15px;
					}

					.wishlist-icon {
							position: relative;
							z-index: 2;
							font-size: 24px;
							color: #333;
							text-decoration: none;
					}

					.wishlist-icon i {
							transition: all 0.3s ease;
					}

					.wishlist-icon.active i {
							color: #ff4d94;
					}

					.wishlist-icon i.zmdi-favorite {
							color: #ff4d94;
					}

					/* Animation for heart icon */
					@keyframes heartPop {
							0% { transform: scale(1); }
							50% { transform: scale(1.2); }
							100% { transform: scale(1); }
					}

					.wishlist-icon.animate i {
							animation: heartPop 0.3s ease;
					}

					.reset-button {
							background: transparent;
							border: none;
							padding: 8px;
							border-radius: 50%;
							cursor: pointer;
							transition: all 0.3s ease;
							color: #666;
							display: flex;
							align-items: center;
							justify-content: center;
					}

					.reset-button i {
							font-size: 18px;
					}

					.reset-button:hover {
							background: #f5f5f5;
							color: #333;
							transform: rotate(180deg);
					}

					.filter-header {
							display: flex;
							align-items: center;
							margin-bottom: 10px;
					}

					/* Common styles for option sections */
					.size-section, .color-section {
							margin: 15px 0;
					}

					.size-section label, .color-section label {
							display: block;
							margin-bottom: 10px;
							font-weight: 600;
							color: #333;
							font-size: 14px;
							text-transform: uppercase;
							letter-spacing: 0.5px;
					}

					/* Size buttons styling */
					.size-options {
							display: flex;
							gap: 8px;
							margin-bottom: 20px;
					}

					.size-btn {
							width: 45px;
							height: 45px;
							border: 2px solid #e0e0e0;
							background: white;
							border-radius: 8px;
							cursor: pointer;
							transition: all 0.2s ease;
							font-weight: 600;
							color: #444;
					}

					.size-btn:hover {
							border-color: #007bff;
							color: #007bff;
							transform: translateY(-2px);
							box-shadow: 0 2px 4px rgba(0,0,0,0.1);
					}

					.size-btn.selected {
							background: #007bff;
							color: white;
							border-color: #007bff;
					}

					/* Color buttons styling */
					.color-options {
							display: flex;
							gap: 8px;
							margin-bottom: 20px;
					}

					.color-btn {
							width: 35px;
							height: 35px;
							border: none;
							border-radius: 50%;
							cursor: pointer;
							transition: all 0.2s ease;
							position: relative;
					}

					.color-btn::after {
							content: '';
							position: absolute;
							top: -4px;
							left: -4px;
							right: -4px;
							bottom: -4px;
							border-radius: 50%;
							border: 2px solid transparent;
							transition: all 0.2s ease;
					}

					.color-btn:hover::after {
							border-color: #007bff;
					}

					.color-btn.selected::after {
							border-color: #007bff;
					}

					/* Quantity selector styling */
					.quantity-selector {
							display: flex;
							align-items: center;
							border: 2px solid #e0e0e0;
							border-radius: 8px;
							overflow: hidden;
							width: fit-content;
					}

					.quantity-selector button {
							padding: 12px 16px;
							border: none;
							background: #f8f9fa;
							cursor: pointer;
							font-weight: bold;
							color: #444;
							transition: all 0.2s ease;
					}

					.quantity-selector button:hover {
							background: #e9ecef;
					}

					.quantity-selector input {
							width: 60px;
							text-align: center;
							border: none;
							padding: 12px 8px;
							font-weight: 600;
							color: #333;
							-moz-appearance: textfield;
					}

					.quantity-selector input::-webkit-outer-spin-button,
					.quantity-selector input::-webkit-inner-spin-button {
							-webkit-appearance: none;
							margin: 0;
					}

					/* Cart section layout */
					.cart-section {
							display: flex;
							align-items: center;
							gap: 20px;
							margin-top: 25px;
					}

					.add-to-cart-btn {
							padding: 12px 24px;
							background: #007bff;
							color: white;
							border: none;
							border-radius: 8px;
							cursor: pointer;
							transition: all 0.3s ease;
							font-weight: 600;
							text-transform: uppercase;
							letter-spacing: 0.5px;
							box-shadow: 0 2px 4px rgba(0,0,0,0.1);
					}

					.add-to-cart-btn:hover {
							background: #0056b3;
							transform: translateY(-2px);
							box-shadow: 0 4px 8px rgba(0,0,0,0.15);
					}

					/* Product options container */
					.product-options {
							background: #f8f9fa;
							padding: 20px;
							border-radius: 12px;
							margin: 15px 0;
					}

					/* Section headers */
					.option-label {
							font-size: 16px;
							color: #2c3e50;
							font-weight: 700;
							margin-bottom: 12px;
							display: block;
					}

					/* Size section */
					.size-options {
							display: inline-flex;
							background: white;
							padding: 5px;
							border-radius: 10px;
							box-shadow: 0 2px 8px rgba(0,0,0,0.08);
							margin-bottom: 25px;
					}

					.size-btn {
							min-width: 50px;
							height: 50px;
							margin: 0 5px;
							border: 2px solid transparent;
							background: white;
							border-radius: 8px;
							cursor: pointer;
							transition: all 0.3s ease;
							font-weight: 600;
							font-size: 15px;
							color: #555;
					}

					.size-btn:hover {
							background: #f0f8ff;
							border-color: #007bff;
							transform: translateY(-2px);
					}

					.size-btn.selected {
							background: #007bff;
							color: white;
							border-color: #007bff;
							box-shadow: 0 2px 8px rgba(0,123,255,0.3);
					}

					/* Color section */
					.color-options {
							display: inline-flex;
							background: white;
							padding: 5px;
							border-radius: 10px;
							box-shadow: 0 2px 8px rgba(0,0,0,0.08);
							margin-bottom: 25px;
					}

					.color-btn {
							width: 40px;
							height: 40px;
							margin: 0 5px;
							border: 3px solid white;
							border-radius: 50%;
							cursor: pointer;
							transition: all 0.3s ease;
							position: relative;
							box-shadow: 0 2px 4px rgba(0,0,0,0.1);
					}

					.color-btn.selected {
							transform: scale(1.15);
							box-shadow: 0 3px 8px rgba(0,0,0,0.2);
					}

					.color-btn:hover {
							transform: scale(1.1);
					}

					/* Quantity section */
					.quantity-selector {
							background: white;
							padding: 5px;
							border-radius: 10px;
							box-shadow: 0 2px 8px rgba(0,0,0,0.08);
							display: inline-flex;
							align-items: center;
					}

					.quantity-selector button {
							width: 40px;
							height: 40px;
							border: none;
							background: #f8f9fa;
							border-radius: 8px;
							font-size: 18px;
							color: #007bff;
							cursor: pointer;
							transition: all 0.2s ease;
					}

					.quantity-selector button:hover {
							background: #e9ecef;
					}

					.quantity-selector input {
							width: 60px;
							text-align: center;
							border: none;
							font-size: 16px;
							font-weight: 600;
							color: #333;
							padding: 8px;
							margin: 0 8px;
					}

					/* Add to cart button */
					.add-to-cart-btn {
							background: linear-gradient(45deg, #007bff, #0056b3);
							color: white;
							border: none;
							padding: 15px 30px;
							border-radius: 10px;
							font-size: 16px;
							font-weight: 600;
							cursor: pointer;
							transition: all 0.3s ease;
							box-shadow: 0 4px 15px rgba(0,123,255,0.2);
							text-transform: uppercase;
							letter-spacing: 1px;
					}

					.add-to-cart-btn:hover {
							transform: translateY(-2px);
							box-shadow: 0 6px 20px rgba(0,123,255,0.3);
					}

					/* Section spacing */
					.size-section, .color-section {
							margin-bottom: 25px;
					}

					/* Stock status */
					.stock-status {
							display: inline-block;
							padding: 8px 15px;
							border-radius: 8px;
							font-weight: 600;
							margin-bottom: 20px;
					}

					.in-stock {
							background: #e8f5e9;
							color: #2e7d32;
					}

					.out-of-stock {
							background: #ffebee;
							color: #c62828;
					}

					.rating-section {
							display: flex;
							align-items: center;
							gap: 10px;
							margin-top: 10px;
					}

					.rating-section .stars {
							display: flex;
							gap: 2px;
					}

					.rating-section .stars i {
							color: #ffc107;
							font-size: 18px;
					}

					.rating-section .rating-count {
							color: #666;
							font-size: 14px;
					}

					.color-filter {
							display: flex;
							flex-direction: column;
					}

					.filter-header {
							display: flex;
							align-items: center;
							justify-content: space-between;
							margin-bottom: 10px;
					}

					.color-filter ul {
							display: flex;
							align-items: center;
							gap: 10px;
							list-style: none;
							padding: 0;
							margin: 0;
					}

					.color-filter ul:first-child {
							margin-right: 15px;
					}

					.color-title {
							font-weight: 600;
							color: #333;
							text-transform: capitalize;
					}

					.color-option {
							width: 25px;
							height: 25px;
							border-radius: 50%;
							cursor: pointer;
							position: relative;
							display: block;
							border: 2px solid transparent;
							transition: all 0.2s ease;
					}

					.color-option .color {
							width: 100%;
							height: 100%;
							border-radius: 50%;
							display: block;
					}

					.color-option.active {
							border: 2px solid #007bff;
							transform: scale(1.05);
							box-shadow: 0 0 0 1px rgba(0, 123, 255, 0.3);
					}

					.color-option:hover {
							transform: scale(1.02);
							box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
					}

					.size-filter input[type="radio"] {
							display: none;
					}

					.size-filter .size-option {
							display: inline-block;
							padding: 8px 16px;
							border: 2px solid #e0e0e0;
							border-radius: 8px;
							cursor: pointer;
							transition: all 0.2s ease;
							font-weight: 600;
							color: #444;
							margin: 0 5px;
					}

					.size-filter input[type="radio"]:checked + .size-option {
							background: #007bff;
							color: white;
							border-color: #007bff;
							transform: translateY(-2px);
							box-shadow: 0 2px 4px rgba(0,0,0,0.1);
					}

					.size-filter .size-option:hover {
							border-color: #007bff;
							color: #007bff;
							transform: translateY(-2px);
							box-shadow: 0 2px 4px rgba(0,0,0,0.1);
					}

					.size-filter .size-option.disabled {
							opacity: 0.5;
							pointer-events: none;
							cursor: not-allowed;
					}

					.size-filter {
							display: flex;
							flex-direction: column;
							gap: 15px;
					}

					.size-options-container {
							display: flex;
							flex-wrap: wrap;
							gap: 10px;
					}

					.size-option-wrapper {
							display: inline-block;
					}

					.variant-error {
							color: #dc3545;
							font-size: 14px;
							margin-top: 10px;
							margin-bottom: 15px;
							display: none;
					}

					.variant-error.show {
							display: block;
					}

					.out-of-stock-message {
							text-align: center;
							padding: 20px;
							background: #fff5f5;
							border-radius: 8px;
							margin: 20px 0;
					}

					.out-of-stock-message h3 {
							color: #dc3545;
							margin-bottom: 10px;
							font-size: 24px;
					}

					.out-of-stock-message p {
							color: #666;
							margin: 0;
					}
		</style>

	 		
		<!-- Google Font -->
		<link href='https://fonts.googleapis.com/css?family=Lato:400,700,900' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Bree+Serif' rel='stylesheet' type='text/css'>

		<!-- all css here -->
	<!-- bootstrap v3.3.6 css -->
	<link rel="stylesheet" href="/user/css/bootstrap.min.css">
	<!-- animate css -->
	<link rel="stylesheet" href="/user/css/animate.min.css">
	<!-- jquery-ui.min css -->
	<link rel="stylesheet" href="/user/css/jquery-ui.min.css">
	<!-- meanmenu css -->
	<link rel="stylesheet" href="/user/css/meanmenu.min.css">
	<!-- nivo-slider css -->
	<link rel="stylesheet" href="/user/lib/css/nivo-slider.css">
	<link rel="stylesheet" href="/user/lib/css/preview.css">
	<!-- slick css -->
	<link rel="stylesheet" href="/user/css/slick.min.css">
	<!-- lightbox css -->
	<link rel="stylesheet" href="/user/css/lightbox.min.css">
	<!-- material-design-iconic-font css -->
	<link rel="stylesheet" href="/user/css/material-design-iconic-font.css">
	<!-- All common css of theme -->
	<link rel="stylesheet" href="/user/css/default.css">
	<!-- style css -->
	<link rel="stylesheet" href="/user/style.min.css">
	<!-- shortcode css -->
	<link rel="stylesheet" href="/user/css/shortcode.css">
	<!-- responsive css -->
	<link rel="stylesheet" href="/user/css/responsive.css">
	<!-- modernizr css -->
	<script src="/user/js/vendor/modernizr-3.11.2.min.js"></script>
	<style>
		.magnify{
		border-radius: 10%;
		border: 2px solid black;
		position: absolute;
		z-index: 20;
		background-repeat: no-repeat;
		background-color: white;
		display: none;
		cursor: none;
	}
	.offer-badge {
			position: absolute;
			top: 15px;
			right: 15px;
			background-color: #4CAF50;
			color: white;
			padding: 8px 15px;
			border-radius: 25px;
			font-size: 14px;
			font-weight: bold;
			z-index: 10;
			box-shadow: 0 3px 6px rgba(0,0,0,0.16);
			text-transform: uppercase;
		}
		.out-of-stock {
					color: #e74c3c;
					font-size: 16px;
					font-weight: 600;
					margin: 10px 0;
					letter-spacing: 0.5px;
					position: relative;
					
			}

			.out-of-stock::before {
					
					position: absolute;
					left: 0;
					top: 10%;
					
					font-size: 20px;
					font-weight: 700;
			}
			.product-image-container {
					position: relative;
					padding-top: 100%;
					overflow: hidden;
					border-radius: 8px;
					background: #f5f5f5;
			}

			.product-image-container img {
					position: absolute;
					top: 0;
					left: 0;
					width: 100%;
					height: 100%;
					object-fit: cover;
					transition: transform 0.3s ease;
			}

			.product-details {
					padding: 15px 5px 0;
			}

			.product-name {
					font-size: 14px;
					line-height: 1.4;
					height: 2.8em;
					overflow: hidden;
					text-overflow: ellipsis;
					display: -webkit-box;
					-webkit-line-clamp: 2;
					-webkit-box-orient: vertical;
					margin-bottom: 8px;
					font-weight: 500;
					color: #333;
			}

			.price-container {
					display: flex;
					align-items: center;
					gap: 8px;
			}

			.current-price {
					font-size: 16px;
					font-weight: 700;
					color: #2ecc71;
			}

			.original-price {
					font-size: 13px;
					color: #888;
					text-decoration: line-through;
			}

			.related-offer-badge {
					position: absolute;
					top: 12px;
					right: 12px;
					background: #4CAF50;
					color: white;
					padding: 4px 10px;
					border-radius: 15px;
					font-size: 12px;
					font-weight: 600;
					z-index: 2;
					box-shadow: 0 2px 5px rgba(0,0,0,0.1);
			}

			@media (max-width: 768px) {
					.product-card {
							flex: 0 0 calc(33.33% - 20px);
					}
					
					.product-name {
							font-size: 13px;
					}
					
					.current-price {
							font-size: 14px;
					}
			}
	</style>
		</head>
		<body>	
			<!-- WRAPPER START -->
			<div class="wrapper bg-dark-white">

		
				<!-- HEADER-AREA END -->
				
				<!-- Mobile-menu end -->
				<!-- HEADING-BANNER START -->
				<div class="main">

			
				<div class="heading-banner-area overlay-bg" >
					<div class="container">
						<div class="row">
							<div class="col-md-12">
								<div class="heading-banner">
									<div class="heading-banner-title">
										<h2>Single Product</h2>
									</div>
									<div class="breadcumbs pb-15">
										<ul>
											<li><a href="/user/home">Home</a></li>
											<li><a href="/user/shop">shop</a></li>
											<li><a href="/user/shop/<%= product.category %>"><%= product.category %></a></li>
											<li><%= product.name %></li>
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- HEADING-BANNER END -->
				<!-- PRODUCT-AREA START -->
				<div class="product-area single-pro-area pt-80 pb-80 product-style-2">
					<div class="container">	
						<div class="row shop-list single-pro-info no-sidebar">
							<!-- Single-product start -->
							<div class="col-lg-12">
								<div class="col-lg-12">
									<div class="single-product clearfix">
										<!-- Single-pro-slider Big-photo start -->
										<div class="single-pro-slider single-big-photo view-lightbox slider-for">
										
											<% for (let i = 0; i < 3; i++) { %>
												<% const imageField = `image${i}`; %>
												<div style="position: relative;">
														<% if (product.offer > 0) { %>
																<div class="offer-badge"><%= product.offer %>% OFF</div>
														<% } %>
														<img class="biggimg" src="<%= product.images[i] %>" alt="Product Image" />
												</div>
										<% } %>
										</div>
										<!-- Single-pro-slider Big-photo end -->
								
										<div class="product-info">
											<!-- Product Title and Rating -->
											<div class="fix">
												<h4 class="post-title floatleft"><%= product.name %></h4>
												<div class="wishlist-heart-container">
													<a href="javascript:void(0)" 
														onclick="toggleWishlist(this, '<%= product._id %>')" 
														class="wishlist-icon" 
														data-product-id="<%= product._id %>">
														<i class="zmdi zmdi-favorite-outline"></i>
													</a>
												</div>
												<!-- Moving price section here -->
												<div class="price-section">
													<% if (product.offer > 0) { %>
															<span class="pro-price">
																₹<%= Math.floor(Number(product.price) * (1 - product.offer/100)) %>
																	<span style="text-decoration: line-through; color: #999; margin-left: 8px; font-size: 0.9em;">
																		₹<%= Math.floor(Number(product.price)) %>
																	</span>
															</span>
													<% } else { %>
															<span class="pro-price">₹<%= Math.floor(Number(product.price)) %></span>
													<% } %>
												</div>
												<!-- Replacing the rating section -->
												<div class="rating-section">
													<div class="stars">
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star"></i>
														<i class="zmdi zmdi-star-half"></i>
														<i class="zmdi zmdi-star-outline"></i>
													</div>
													<span class="rating-count">(27 Reviews)</span>
												</div>
											</div>
								
											<!-- Color Section -->
											<div class="color-filter single-pro-color mb-20 clearfix">
												<% 
												// Filter out variants with count > 0 and get unique colors
												const inStockVariants = product.variants.filter(v => v.count > 0);
												const uniqueColors = [...new Set(inStockVariants.map(variant => variant.color))];
												
												if (inStockVariants.length === 0) { %>
													<div class="out-of-stock-message">
														<h3>Out of Stock</h3>
														<p>This product is currently unavailable</p>
													</div>
												<% } else { %>
													<div class="filter-header">
														<ul>
															<li><span class="color-title text-capitalize">color</span></li>
														</ul>
													</div>
													<ul>
														<% uniqueColors.forEach((color, index) => { %>
															<li>
																<a onclick="selectvarient(event)" data-color="<%= color %>" class="color-option <%= index === 0 ? 'active' : '' %>">
																	<span data-color="<%= color %>" class="color" style="background-color: <%= color.toLowerCase() %>"></span>
																</a>
															</li>
														<% }); %>
													</ul>
												<% } %>
											</div>
								
											<!-- Size Section -->
											<div class="size-filter single-pro-size mb-35 clearfix">
												<% if (inStockVariants.length > 0) { %>
													<span class="color-title text-capitalize">size</span>
													<div class="size-options-container">
														<% 
														// Get unique sizes from in-stock variants
														const uniqueSizes = [...new Set(inStockVariants.map(variant => variant.size))];
														uniqueSizes.forEach((size, index) => { 
														%>
															<div class="size-option-wrapper">
																<input type="radio" 
																	   id="size-<%= size %>" 
																	   name="size" 
																	   value="<%= size %>" 
																	   class="size-radio" 
																	   <%= index === 0 ? 'checked' : '' %>
																	   onchange="selectvarient(event, 'size')">
																<label for="size-<%= size %>" 
																	   class="size-option <%= index === 0 ? 'active' : '' %>" 
																	   data-size="<%= size %>">
																	<%= size %>
																</label>
															</div>
														<% }); %>
													</div>
												<% } %>
											</div>
								<!-- new start -->
											<!-- Quantity and Actions -->
									
											
												<div class="clearfix">
													
													<div class="product-actions">
														
														<% if (inStockVariants.length > 0) { %>
															<a class="luxury-button cart-btn" 
																<% if (userid) { %>
																		href="javascript:void(0);" 
																		onclick="addtocart('<%= userid %>','<%= product._id %>'); return false;"
																<% } else { %>
																		href="/user/login"
																<% } %>
															>
																	<i class="zmdi zmdi-shopping-cart"></i>
																	ADD TO CART
															</a>
															<a onclick="<%= userid ? `buy('${product._id}')` : `window.location.href='/user/login'` %>" class="luxury-button buynow-btn">
																BUY NOW
														</a>
														<% } %>
															
													</div>
												</div>
										
										<style>
											

			.related-products {
					padding: 60px 0;
					background: #f9f9f9;
			}

			.related-products .section-title {
					text-align: center;
					margin-bottom: 40px;
					font-size: 28px;
					text-transform: uppercase;
			}

			.related-products-container {
					position: relative;
					max-width: 1200px;
					margin: 0 auto;
					padding: 0 50px;
			}

			.products-grid {
					display: flex;
					overflow-x: hidden;
					scroll-behavior: smooth;
					gap: 30px;
					padding-bottom: 20px;
			}

			.product-card {
					flex: 0 0 calc(20% - 24px);
					background: white;
					padding: 15px;
					border-radius: 12px;
					box-shadow: 0 4px 15px rgba(0,0,0,0.08);
					transition: transform 0.3s ease, box-shadow 0.3s ease;
					position: relative;
					overflow: hidden;
			}

			.product-card:hover {
					transform: translateY(-5px);
					box-shadow: 0 6px 20px rgba(0,0,0,0.12);
			}

			.nav-button {
					position: absolute;
					top: 50%;
					transform: translateY(-50%);
					background: white;
					border: 2px solid #000;
					width: 40px;
					height: 40px;
					border-radius: 50%;
					cursor: pointer;
					display: flex;
					align-items: center;
					justify-content: center;
					z-index: 10;
			}

			.nav-button.prev {
					left: 0;
			}

			.nav-button.next {
					right: 0;
			}
											.product-actions {
													display: flex;
													gap: 15px;
													margin-bottom: 25px;
											}
									
											.luxury-button {
													flex: 1;
													padding: 18px 30px;
													border: 2px solid #000;
													border-radius: 0;
													font-weight: 600;
													text-transform: uppercase;
													letter-spacing: 1.5px;
													font-size: 14px;
													cursor: pointer;
													transition: all 0.3s ease;
													display: flex;
													align-items: center;
													justify-content: center;
													gap: 12px;
													background: #000;
													color: #fff;
													text-decoration: none;
													box-shadow: 0 2px 8px rgba(0,0,0,0.1);
											}
									
											.luxury-button i {
													font-size: 18px;
													color: #fff;
											}
									
											.buynow-btn {
													background: #fff;
													color: #000;
													border-color: #000;
											}
									
											.luxury-button:hover {
													background: #c5a47e; /* Luxury gold tone */
													color: #000;
													border-color: #c5a47e;
													transform: translateY(-2px);
											}
									
											.luxury-button:hover i {
													color: #000;
											}
									
											.buynow-btn:hover {
													background: #f5f5f5;
													border-color: #c5a47e;
											}
									
											@media (max-width: 768px) {
													.product-actions {
															flex-direction: column;
													}
													
													.luxury-button {
															width: 100%;
															padding: 16px 25px;
													}
											}
									</style>
								<!-- new end -->
											<!-- Single-pro-slider Small-photo start -->
											<div class="single-pro-slider single-sml-photo slider-nav">
												<% for (let i = 0; i < 3; i++) { %>
													<% const imageField = `image${i}`; %>
													<div>
														<img src="<%= product.images[i] %>" alt="Small Product Image" />
													</div>
												<% } %>
											</div>
											<!-- Single-pro-slider Small-photo end -->
										</div>
									</div>
								</div>
								
							</div>
							<!-- Single-product end -->
						</div>
						<!-- single-product-tab start -->
						<div class="single-pro-tab">
							<div class="row">
								<div class="col-md-3">
									<div class="single-pro-tab-menu">
										<!-- Nav tabs -->
										<ul class="nav d-block">
											<li><a href="#description" data-bs-toggle="tab">Description</a></li>
											<li><a class="active" href="#reviews"  data-bs-toggle="tab">Reviews</a></li>
											
										</ul>
									</div>
								</div>
								<div class="col-md-9">
									<!-- Tab panes -->
									<div class="tab-content">
										<div class="tab-pane" id="description">
											<div class="pro-tab-info pro-description">
												<p><%= product.descr%></p>
											</div>
										</div>
										<div class="tab-pane" id="reviews">
											<div class="pro-tab-info pro-reviews">
												<div class="customer-review mb-60">
													<h3 class="tab-title title-border mb-30">Customer review</h3>
													<ul class="product-comments clearfix">
														<li class="mb-30">
															<div class="pro-reviewer">
																<img src="img/reviewer/1.jpg" alt="" />
															</div>
															<div class="pro-reviewer-comment">
																<div class="fix">
																	<div class="floatleft mbl-center">
																		<h5 class="text-uppercase mb-0"><strong>Gerald Barnes</strong></h5>
																		<p class="reply-date">27 Jun, 2021 at 2:30pm</p>
																	</div>
																	<div class="comment-reply floatright">
																		<a href="#"><i class="zmdi zmdi-mail-reply"></i></a>
																		<a href="#"><i class="zmdi zmdi-close"></i></a>
																	</div>
																</div>
																<p class="mb-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer accumsan egestas elese ifend. Phasellus a felis at est bibendum feugiat ut eget eni Praesent et messages in con sectetur posuere dolor non.</p>
															</div>
														</li>
														<li class="threaded-comments">
															<div class="pro-reviewer">
																<img src="img/reviewer/1.jpg" alt="" />
															</div>
															<div class="pro-reviewer-comment">
																<div class="fix">
																	<div class="floatleft mbl-center">
																		<h5 class="text-uppercase mb-0"><strong>Gerald Barnes</strong></h5>
																		<p class="reply-date">27 Jun, 2021 at 2:30pm</p>
																	</div>
																	<div class="comment-reply floatright">
																		<a href="#"><i class="zmdi zmdi-mail-reply"></i></a>
																		<a href="#"><i class="zmdi zmdi-close"></i></a>
																	</div>
																</div>
																<p class="mb-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer accumsan egestas elese ifend. Phasellus a felis at est bibendum feugiat ut eget eni Praesent et messages in con sectetur posuere dolor non.</p>
															</div>
														</li>
													</ul>
												</div>
												<div class="leave-review">
													<h3 class="tab-title title-border mb-30">Leave your reviw</h3>
													<div class="your-rating mb-30">
														<p class="mb-10"><strong>Your Rating</strong></p>
														<span>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
														</span>
														<span class="separator">|</span>
														<span>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
														</span>
														<span class="separator">|</span>
														<span>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
														</span>
														<span class="separator">|</span>
														<span>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
														</span>
														<span class="separator">|</span>
														<span>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
															<a href="#"><i class="zmdi zmdi-star-outline"></i></a>
														</span>
													</div>
													<div class="reply-box">
														<form action="#">
															<div class="row">
																<div class="col-md-6">
																	<input type="text" placeholder="Your name here..." name="name" />
																</div>
																<div class="col-md-6">
																	<input type="text" placeholder="Subject..." name="name" />
																</div>
															</div>
															<div class="row">
																<div class="col-md-12">
																	<textarea class="custom-textarea" name="message" placeholder="Your review here..." ></textarea>
																	<button type="submit" data-text="submit review" class="button-one submit-button mt-20">submit review</button>
																</div>
															</div>
														</form>
													</div>
												</div>
											</div>		
										</div>
										
									</div>									
								</div>
							</div>
						</div>
						<!-- single-product-tab end -->
					</div>
				</div>
			</div>
				<!-- PRODUCT-AREA END -->
				<!-- FOOTER START -->
				<div class="related-products">
					<div class="container">
							<h2 class="section-title">Related Products</h2>
							<div class="related-products-container">
									<button class="nav-button prev">❮</button>
									<button class="nav-button next">❯</button>
									<div class="products-grid">
											<% relatedProducts.forEach(relatedProduct => { %>
													<div class="product-card">
															<div class="product-image-container">
																	<% if (relatedProduct.offer > 0) { %>
																			<div class="related-offer-badge"><%= relatedProduct.offer %>% OFF</div>
																	<% } %>
																	<a href="/user/product/<%= relatedProduct.name %>">
																		<img src="<%= relatedProduct.image0 %>" alt="<%= relatedProduct.name %>">
																	</a>
															</div>
															<div class="product-details">
																	<h3 class="product-name"><%= relatedProduct.name %></h3>
																	<div class="price-container">
																			<% if (relatedProduct.offer > 0) { %>
																					<% const discountedPrice = Math.floor(relatedProduct.price * (1 - relatedProduct.offer/100)) %>
																					<span class="current-price">₹<%= discountedPrice %></span>
																					<span class="original-price">₹<%= Math.floor(relatedProduct.price) %></span>
																			<% } else { %>
																					<span class="current-price">₹<%= Math.floor(relatedProduct.price) %></span>
																			<% } %>
																	</div>
															</div>
													</div>
											<% }); %>
									</div>
							</div>
					</div>
			</div>
			
				<footer>
					<!-- Footer-area start -->
					<div class="footer-area footer-2">
											<div class="container">
													<div class="row">
															<div class="col-lg-4 col-md-6">
																	<div class="single-footer">
																			<h3 class="footer-title  title-border">Contact Us</h3>
																			<ul class="footer-contact">
																					<li><span>Address :</span>28 Green Tower, Street Name,<br>New York City, USA</li>
																					<li><span>Cell-Phone :</span>012345 - 123456789</li>
																					<li><span>Email :</span>your-email@gmail.com</li>
																			</ul>
																	</div>
															</div>
															<div class="col-lg-2 col-md-3 col-sm-6">
																	<div class="single-footer">
																			<h3 class="footer-title  title-border">accounts</h3>
																			<ul class="footer-menu">
																					<li><a href="my-account.html"><i class="zmdi zmdi-dot-circle"></i>My Account</a></li>
																					<li><a href="wishlist.html"><i class="zmdi zmdi-dot-circle"></i>My Wishlist</a></li>
																					<li><a href="cart.html"><i class="zmdi zmdi-dot-circle"></i>My Cart</a></li>
																					<li><a href="login.html"><i class="zmdi zmdi-dot-circle"></i>Sign In</a></li>
																					<li><a href="checkout.html"><i class="zmdi zmdi-dot-circle"></i>Check out</a></li>
																			</ul>
																	</div>
															</div>
															<div class="col-lg-2 col-md-3 col-sm-6">
																	<div class="single-footer">
																			<h3 class="footer-title  title-border">shipping</h3>
																			<ul class="footer-menu">
																					<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>New Products</a></li>
																					<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Top Sellers</a></li>
																					<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Manufactirers</a></li>
																					<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Suppliers</a></li>
																					<li><a href="#"><i class="zmdi zmdi-dot-circle"></i>Specials</a></li>
																			</ul>
																	</div>
															</div>
															<div class="col-lg-4 col-md-6">
																	<div class="single-footer newsletter-item">
																			<h3 class="footer-title  title-border">Email Newsletters</h3>
																			<div class="footer-subscribe">
																					<form action="#">
																							<input type="text" name="email" placeholder="Email Address..." />
																							<button class="button-one submit-btn-4" type="submit" data-text="Subscribe">Subscribe</button>
																					</form>
																			</div>
																	</div>
															</div>
													</div>
											</div>
									</div>
					<!-- Footer-area end -->
					<!-- Copyright-area start -->
					<div class="copyright-area copyright-2">
						<div class="container">
							<div class="row">
								<div class="col-md-6">
									<div class="copyright">
										<p class="mb-0">&copy; <a href="https://themeforest.net/user/codecarnival/portfolio" target="_blank">CodeCarnival </a> 2022. All Rights Reserved.</p>
									</div>
								</div>
								<div class="col-md-6">
									<div class="payment  text-md-end">
										<a href="#"><img src="img/payment/1.png" alt="" /></a>
										<a href="#"><img src="img/payment/2.png" alt="" /></a>
										<a href="#"><img src="img/payment/3.png" alt="" /></a>
										<a href="#"><img src="img/payment/4.png" alt="" /></a>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- Copyright-area start -->
				</footer>
				<!-- FOOTER END -->
				<!-- QUICKVIEW PRODUCT -->
				
				<!-- END QUICKVIEW PRODUCT -->	
				
			</div>
			<!-- WRAPPER END -->
			<div class="custom-notification" id="customNotification">
				<span class="notification-message"></span>
		</div>
			<!-- all js here -->
	<!-- jquery latest version -->
	<script src="/user/js/vendor/jquery-3.6.0.min.js"></script>
	<script src="/user/js/vendor/jquery-migrate-3.3.2.min.js"></script>
	<!-- bootstrap js -->
	<script src="/user/js/bootstrap.bundle.min.js"></script>
	<!-- jquery.meanmenu js -->
	<script src="/user/js/jquery.meanmenu.js"></script>
	<!-- slick.min js -->
	<script src="/user/js/slick.min.js"></script>
	<!-- jquery.treeview js -->
	<script src="/user/js/jquery.treeview.js"></script>
	<!-- lightbox.min js -->
	<script src="/user/js/lightbox.min.js"></script>
	<!-- jquery-ui js -->
	<script src="/user/js/jquery-ui.min.js"></script>
	<!-- jquery.nivo.slider js -->
	<script src="/user/lib/js/jquery.nivo.slider.js"></script>
	<script src="/user/lib/home.js"></script>
	<!-- jquery.nicescroll.min js -->
	<script src="/user/js/jquery.nicescroll.min.js"></script>
	<!-- countdon.min js -->
	<script src="/user/js/countdon.min.js"></script>
	<!-- wow js -->
	<script src="/user/js/wow.min.js"></script>
	<!-- plugins js -->
	<script src="/user/js/plugins.js"></script>
	<!-- main js -->
	<script src="/user/js/main.min.js"></script>
	<script>



		/*Size is  set in pixels... supports being written as: '250px' */
	var magnifierSize = 150;

	/*How many times magnification of image on page.*/
	var magnification = 4;

	function magnifier() {

		this.magnifyImg = function(ptr, magnification, magnifierSize) {
			var $pointer;
			if (typeof ptr == "string") {
				$pointer = $(ptr);
			} else if (typeof ptr == "object") {
				$pointer = ptr;
			}
			
			if(!($pointer.is('img'))){
				alert('Object must be image.');
				return false;
			}

			magnification = +(magnification);

			$pointer.hover(function() {
				$(this).css('cursor', 'none');
				$('.magnify').show();
				//Setting some variables for later use
				var width = $(this).width();
				var height = $(this).height();
				var src = $(this).attr('src');
				var imagePos = $(this).offset();
				var image = $(this);

				if (magnifierSize == undefined) {
					magnifierSize = '150px';
				}

				$('.magnify').css({
					'background-size': width * magnification + 'px ' + height * magnification + "px",
					'background-image': 'url("' + src + '")',
					'width': magnifierSize,
					'height': magnifierSize
				});

				//Setting a few more...
				var magnifyOffset = +($('.magnify').width() / 2);
				var rightSide = +(imagePos.left + $(this).width());
				var bottomSide = +(imagePos.top + $(this).height());

				$(document).mousemove(function(e) {
					if (e.pageX < +(imagePos.left - magnifyOffset / 6) || e.pageX > +(rightSide + magnifyOffset / 6) || e.pageY < +(imagePos.top - magnifyOffset / 6) || e.pageY > +(bottomSide + magnifyOffset / 6)) {
						$('.magnify').hide();
						$(document).unbind('mousemove');
					}
					var backgroundPos = "" - ((e.pageX - imagePos.left) * magnification - magnifyOffset) + "px " + -((e.pageY - imagePos.top) * magnification - magnifyOffset) + "px";
					$('.magnify').css({
						'left': e.pageX - magnifyOffset,
						'top': e.pageY - magnifyOffset,
						'background-position': backgroundPos
					});
				});
			}, function() {

			});
		};

		this.init = function() {
			$('body').prepend('<div class="magnify"></div>');
		}

		return this.init();
	}

	var magnify = new magnifier();
	magnify.magnifyImg('.biggimg', magnification, magnifierSize);


	function addtocart(userid, productid) {
		// Check if both color and size are selected
		if (!varienttosend.color || !varienttosend.size) {
			showCustomAlert('Please select both color and size');
			return;
		}
		
		fetch('/user/addtocart', {
			method: 'post',
			body: JSON.stringify({ productid, userid, varient:varienttosend }),
			headers: { 'Content-Type': 'application/json' }
		})
		.then(response => response.json())
		.then(data => {
			if (data.message === 'product added to cart') {
				document.querySelectorAll('.action-badge')[1].textContent = parseInt(document.querySelectorAll('.action-badge')[1].textContent) + 1;
				showCustomAlert('Added To Cart');
			} else if (data.message === 'product already exist') {
				showCustomAlert('Product already in cart');
			}
		})
		.catch((err) => {
			console.log(err);
		});
	}

	function buy(id) {
		// Check if both color and size are selected
		if (!varienttosend.color || !varienttosend.size) {
			showCustomAlert('Please select both color and size');
			return;
		}

		const cartItems = {};
		cartItems['1'] = {
				productId: id,
				quantity: 1,
				size: varienttosend.size,
				color: varienttosend.color
		};
		fetch('/user/checkout', {
				method: 'POST',
				headers: {
						'Content-Type': 'application/json'
				},
				body: JSON.stringify({cartItems})
		})
		.then(response => response.text())
		.then(html => {
				document.open();
				document.write(html);
				document.close();
		})
		.catch(error => console.error('Error:', error));
	}


	function showCustomAlert(message) {
							const notification = document.getElementById('customNotification');
							const messageElement = notification.querySelector('.notification-message');
							
							messageElement.textContent = message;
							notification.classList.add('active');
							
							// Hide after 3 seconds
							setTimeout(() => {
									notification.classList.remove('active');
							}, 2000);
					}

	
	// Related products carousel navigation
	// const productsGrid = document.querySelector('.products-grid');
	// 		const scrollAmount = document.querySelector('.product-card').offsetWidth * 5 + 30 * 5;
			
	// 		document.querySelector('.nav-button.next').addEventListener('click', () => {
	// 				productsGrid.scrollBy({ left: scrollAmount, behavior: 'smooth' });
	// 		});

	// 		document.querySelector('.nav-button.prev').addEventListener('click', () => {
	// 				productsGrid.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
	// 		});

	async function toggleWishlist(element, productId) {
		try {
			
			const isActive = element.classList.contains('active');
			const url = isActive ? `/user/wishlist/remove/${productId}` : `/user/wishlist/add/${productId}`;
			const method = isActive ? 'DELETE' : 'POST';

			const response = await fetch(url, { method });
			const contentType = response.headers.get('content-type');

			if (contentType && contentType.includes('text/html')) {
				// If response is HTML, render it
				const html = await response.text();
				document.open();
				document.write(html);
				document.close();
				return;
			}

			const data = await response.json();

			if (response.ok) {
				// Toggle the active class
				element.classList.toggle('active');
				
				// Toggle the heart icon
				const icon = element.querySelector('i');
				icon.classList.toggle('zmdi-favorite-outline');
				icon.classList.toggle('zmdi-favorite');
				
				// Add animation class
				element.classList.add('animate');
				setTimeout(() => element.classList.remove('animate'), 300);

				// Show notification
				showCustomAlert(isActive ? 'Removed from wishlist' : 'Added to wishlist');

				// Update wishlist count in header
				const wishlistBadge = document.querySelector('.action-link[href="/user/wishlist"] .action-badge');
				if (wishlistBadge) {
					const currentCount = parseInt(wishlistBadge.textContent);
					wishlistBadge.textContent = isActive ? currentCount - 1 : currentCount + 1;
				}
			} else {
				// Show error message in red
				const errorMessage = document.getElementById('customNotification');
				errorMessage.style.backgroundColor = '#ff0000';
				showCustomAlert(data.message || 'Error updating wishlist');
				setTimeout(() => {
					errorMessage.style.backgroundColor = '#333';
				}, 2000);
			}
		} catch (error) {
			console.error('Error toggling wishlist:', error);
			const errorMessage = document.getElementById('customNotification');
			errorMessage.style.backgroundColor = '#ff0000';
			showCustomAlert('Error updating wishlist');
			setTimeout(() => {
				errorMessage.style.backgroundColor = '#333';
			}, 2000);
		}
	}

	// When page loads, check if product is in wishlist
	document.addEventListener('DOMContentLoaded', async () => {
		try {
			const wishlistIcon = document.querySelector('.wishlist-icon');
			if (!wishlistIcon) return; // Exit if no wishlist icon found
			
			const currentProductId = wishlistIcon.dataset.productId;
			if (!currentProductId) return; // Exit if no product ID found

			const response = await fetch('/user/wishlist/check', { method: 'GET' });
			if (response.ok) {
				const wishlistProducts = await response.json();
				
				// Check if current product is in wishlist array
				const isInWishlist = wishlistProducts.includes(currentProductId);
				
				if (isInWishlist) {
					wishlistIcon.classList.add('active');
					const icon = wishlistIcon.querySelector('i');
					if (icon) {
						icon.classList.remove('zmdi-favorite-outline');
						icon.classList.add('zmdi-favorite');
					}
				}
			}
		} catch (error) {
			console.error('Error checking wishlist status:', error);
		}
	});

	let varienttosend = {};
	const varients = <%- JSON.stringify(product.variants.filter(v => v.count > 0)) %>;

	function selectvarient(event, varient) {
		if (!varients.length) return; // Exit if no in-stock variants
		
		if(varient === 'size') {
			// Handle size selection
			const selectedsize = event.target.value;
			varienttosend.size = selectedsize;
			
			// Update size options UI
			document.querySelectorAll('.size-option').forEach(option => {
				option.classList.remove('active');
			});

			// Add active class to selected size
			const selectedLabel = document.querySelector(`label[data-size="${selectedsize}"]`);
			selectedLabel.classList.add('active');
			
		} else {
			// Handle color selection
			const selectedColor = event.target.dataset.color;
			varienttosend.color = selectedColor;
			
			// Remove active class from all color options
			document.querySelectorAll('.color-option').forEach(option => {
				option.classList.remove('active');
			});

			// Add active class to clicked color
			event.target.closest('.color-option').classList.add('active');

			// Filter variants that match the selected color and have stock
			const matchingVariants = varients.filter(variant => 
				variant.color === selectedColor && variant.count > 0
			);
			const availableSizes = matchingVariants.map(variant => variant.size);
			
			// Update size options - disable unavailable sizes
			document.querySelectorAll('.size-option').forEach(option => {
				const size = option.dataset.size;
				if (availableSizes.includes(size)) {
					option.classList.remove('disabled');
					option.style.pointerEvents = 'auto';
					option.style.opacity = '1';
				} else {
					option.classList.add('disabled');
					option.style.pointerEvents = 'none';
					option.style.opacity = '0.5';
				}
			});

			// Reset size selection when color changes
			document.querySelectorAll('input[type="radio"][name="size"]').forEach(radio => {
				radio.checked = false;
			});
			delete varienttosend.size;
		}
	}

	// Auto-select first color and size on page load
	document.addEventListener('DOMContentLoaded', function() {
		// Select first color
		const firstColorOption = document.querySelector('.color-option');
		if (firstColorOption) {
			const firstColor = firstColorOption.querySelector('.color').dataset.color;
			firstColorOption.classList.add('active');
			varienttosend.color = firstColor;

			// Filter variants for the first color
			const matchingVariants = varients.filter(variant => variant.color === firstColor);
			const availableSizes = matchingVariants.map(variant => variant.size);

			// Update size options visibility
			document.querySelectorAll('.size-option').forEach(option => {
				const size = option.dataset.size;
				if (availableSizes.includes(size)) {
					option.classList.remove('disabled');
					option.style.pointerEvents = 'auto';
					option.style.opacity = '1';
				} else {
					option.classList.add('disabled');
					option.style.pointerEvents = 'none';
					option.style.opacity = '0.5';
				}
			});

			// Select first available size
			const firstAvailableSize = availableSizes[0];
			if (firstAvailableSize) {
				const firstSizeRadio = document.querySelector(`input[type="radio"][value="${firstAvailableSize}"]`);
				const firstSizeLabel = document.querySelector(`label[data-size="${firstAvailableSize}"]`);
				
				if (firstSizeRadio && firstSizeLabel) {
					firstSizeRadio.checked = true;
					firstSizeLabel.classList.add('active');
					varienttosend.size = firstAvailableSize;
				}
			}
		}
	});

</script>
		</body>

	<!-- Mirrored from template.hasthemes.com/hurst-v1/hurst/single-product.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 15 Jan 2025 07:07:04 GMT -->
	</html>
